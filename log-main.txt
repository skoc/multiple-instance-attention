
Load Dataset
label column: label
label dictionary: {'subtype_a': 0, 'subtype_b': 1, 'subtype_c': 2}
number of classes: 3
slide-level counts:  
 1    9
0    5
2    5
Name: label, dtype: int64
Patient-LVL; Number of samples registered in class 0: 5
Slide-LVL; Number of samples registered in class 0: 5
Patient-LVL; Number of samples registered in class 1: 9
Slide-LVL; Number of samples registered in class 1: 9
Patient-LVL; Number of samples registered in class 2: 5
Slide-LVL; Number of samples registered in class 2: 5
split_dir:  splits/task_2_pannet_subtyping_100/
################# Settings ###################
num_splits:  10
k_start:  -1
k_end:  -1
task:  task_2_pannet_subtyping
max_epochs:  50
results_dir:  ./results
lr:  0.0002
experiment:  task_2_pannet_subtyping_CLAM_100
reg:  1e-05
label_frac:  1.0
bag_loss:  ce
seed:  1
model_type:  clam_mb
model_size:  small
use_drop_out:  True
weighted_sample:  True
opt:  adam
bag_weight:  0.7
inst_loss:  svm
B:  8
split_dir:  splits/task_2_pannet_subtyping_100/

Training Fold 0!

Init train/val/test splits... 
Done!
Training on 17 samples
Validating on 1 samples
Testing on 1 samples

Init loss function... Done!

Init Model... Setting tau to 1.0
Done!
CLAM_MB(
  (attention_net): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.25, inplace=False)
    (3): Attn_Net_Gated(
      (attention_a): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_b): Sequential(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): Sigmoid()
        (2): Dropout(p=0.25, inplace=False)
      )
      (attention_c): Linear(in_features=256, out_features=3, bias=True)
    )
  )
  (classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=1, bias=True)
    (1): Linear(in_features=512, out_features=1, bias=True)
    (2): Linear(in_features=512, out_features=1, bias=True)
  )
  (instance_classifiers): ModuleList(
    (0): Linear(in_features=512, out_features=2, bias=True)
    (1): Linear(in_features=512, out_features=2, bias=True)
    (2): Linear(in_features=512, out_features=2, bias=True)
  )
  (instance_loss_fn): SmoothTop1SVM()
)
Total number of parameters: 792844
Total number of trainable parameters: 792844

Init optimizer ... Done!

Init Loaders... Done!

Setup EarlyStopping... Done!




class 0 clustering acc 0.9166666666666666: correct 374/408
class 1 clustering acc 0.10294117647058823: correct 14/136
Epoch: 0, train_loss: 1.0357, train_clustering_loss:  1.1461, train_error: 0.4706
class 0: acc 0.9, correct 9/10
class 1: acc 0.0, correct 0/4
class 2: acc 0.0, correct 0/3
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.4803, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
Validation loss decreased (inf --> 1.480260).  Saving model ...




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 1, train_loss: 1.2565, train_clustering_loss:  0.9846, train_error: 0.7647
class 0: acc 1.0, correct 4/4
class 1: acc 0.0, correct 0/5
class 2: acc 0.0, correct 0/8
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.2396, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
Validation loss decreased (1.480260 --> 1.239578).  Saving model ...




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 2, train_loss: 1.0673, train_clustering_loss:  0.8749, train_error: 0.5294
class 0: acc 0.6, correct 3/5
class 1: acc 0.2222222222222222, correct 2/9
class 2: acc 1.0, correct 3/3
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 0.9373, val_error: 0.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 1.0, correct 1/1
class 2: acc None, correct 0/0
Validation loss decreased (1.239578 --> 0.937252).  Saving model ...




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 3, train_loss: 1.1475, train_clustering_loss:  0.8123, train_error: 0.6471
class 0: acc 0.0, correct 0/5
class 1: acc 1.0, correct 6/6
class 2: acc 0.0, correct 0/6
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 0.8480, val_error: 0.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 1.0, correct 1/1
class 2: acc None, correct 0/0
Validation loss decreased (0.937252 --> 0.848013).  Saving model ...




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 4, train_loss: 1.1468, train_clustering_loss:  0.8039, train_error: 0.8235
class 0: acc 0.0, correct 0/4
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.2, correct 2/10
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.1663, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 1 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 5, train_loss: 0.9941, train_clustering_loss:  0.7651, train_error: 0.4706
class 0: acc 0.0, correct 0/4
class 1: acc 0.0, correct 0/4
class 2: acc 1.0, correct 9/9
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.3337, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 2 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 6, train_loss: 1.0234, train_clustering_loss:  0.7531, train_error: 0.5294
class 0: acc 0.0, correct 0/2
class 1: acc 0.0, correct 0/7
class 2: acc 1.0, correct 8/8
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.1906, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 3 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 7, train_loss: 0.9130, train_clustering_loss:  0.7394, train_error: 0.4706
class 0: acc 0.0, correct 0/1
class 1: acc 0.0, correct 0/7
class 2: acc 1.0, correct 9/9
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.1017, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 4 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 8, train_loss: 1.3311, train_clustering_loss:  0.7948, train_error: 0.7647
class 0: acc 0.0, correct 0/8
class 1: acc 0.16666666666666666, correct 1/6
class 2: acc 1.0, correct 3/3
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 0.8470, val_error: 0.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 1.0, correct 1/1
class 2: acc None, correct 0/0
Validation loss decreased (0.848013 --> 0.847017).  Saving model ...




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 9, train_loss: 1.0788, train_clustering_loss:  0.7719, train_error: 0.5294
class 0: acc 0.0, correct 0/6
class 1: acc 1.0, correct 7/7
class 2: acc 0.25, correct 1/4
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 0.9438, val_error: 0.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 1.0, correct 1/1
class 2: acc None, correct 0/0
EarlyStopping counter: 1 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 10, train_loss: 1.0460, train_clustering_loss:  0.7661, train_error: 0.3529
class 0: acc 0.75, correct 3/4
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.3333333333333333, correct 2/6
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 0.8899, val_error: 0.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 1.0, correct 1/1
class 2: acc None, correct 0/0
EarlyStopping counter: 2 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 11, train_loss: 0.9985, train_clustering_loss:  0.7681, train_error: 0.5294
class 0: acc 0.36363636363636365, correct 4/11
class 1: acc 1.0, correct 4/4
class 2: acc 0.0, correct 0/2
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.0492, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 3 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 12, train_loss: 1.1040, train_clustering_loss:  0.7740, train_error: 0.5882
class 0: acc 1.0, correct 6/6
class 1: acc 0.0, correct 0/4
class 2: acc 0.14285714285714285, correct 1/7
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.2572, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 4 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 13, train_loss: 0.9754, train_clustering_loss:  0.7480, train_error: 0.4706
class 0: acc 1.0, correct 8/8
class 1: acc 0.0, correct 0/6
class 2: acc 0.3333333333333333, correct 1/3
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.3046, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 5 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 14, train_loss: 1.0630, train_clustering_loss:  0.7644, train_error: 0.6471
class 0: acc 1.0, correct 5/5
class 1: acc 0.125, correct 1/8
class 2: acc 0.0, correct 0/4
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.0068, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 6 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 15, train_loss: 1.0248, train_clustering_loss:  0.7456, train_error: 0.4118
class 0: acc 0.8888888888888888, correct 8/9
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.2, correct 1/5
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.1703, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 7 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 16, train_loss: 0.9789, train_clustering_loss:  0.7546, train_error: 0.5294
class 0: acc 1.0, correct 5/5
class 1: acc 0.16666666666666666, correct 1/6
class 2: acc 0.3333333333333333, correct 2/6
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.0860, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 8 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 17, train_loss: 0.9645, train_clustering_loss:  0.7518, train_error: 0.2941
class 0: acc 0.5714285714285714, correct 4/7
class 1: acc 1.0, correct 3/3
class 2: acc 0.7142857142857143, correct 5/7
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.2910, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 9 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 18, train_loss: 1.0153, train_clustering_loss:  0.7434, train_error: 0.3529
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.0, correct 0/4
class 2: acc 0.8333333333333334, correct 5/6
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.4293, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 10 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 19, train_loss: 0.9382, train_clustering_loss:  0.7482, train_error: 0.3529
class 0: acc 0.5, correct 2/4
class 1: acc 0.0, correct 0/4
class 2: acc 1.0, correct 9/9
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.5994, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 11 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 20, train_loss: 1.0364, train_clustering_loss:  0.7402, train_error: 0.5294
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.0, correct 0/7
class 2: acc 0.6666666666666666, correct 2/3
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.2992, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 12 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 21, train_loss: 0.9896, train_clustering_loss:  0.7420, train_error: 0.4118
class 0: acc 1.0, correct 5/5
class 1: acc 0.625, correct 5/8
class 2: acc 0.0, correct 0/4
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 0.9201, val_error: 0.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 1.0, correct 1/1
class 2: acc None, correct 0/0
EarlyStopping counter: 13 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 22, train_loss: 0.9624, train_clustering_loss:  0.7195, train_error: 0.5294
class 0: acc 0.42857142857142855, correct 3/7
class 1: acc 1.0, correct 2/2
class 2: acc 0.375, correct 3/8
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.0972, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 14 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 23, train_loss: 0.8909, train_clustering_loss:  0.7072, train_error: 0.2353
class 0: acc 1.0, correct 2/2
class 1: acc 1.0, correct 8/8
class 2: acc 0.42857142857142855, correct 3/7
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 0.9540, val_error: 0.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 1.0, correct 1/1
class 2: acc None, correct 0/0
EarlyStopping counter: 15 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 24, train_loss: 0.9399, train_clustering_loss:  0.7271, train_error: 0.4118
class 0: acc 0.0, correct 0/4
class 1: acc 1.0, correct 6/6
class 2: acc 0.5714285714285714, correct 4/7
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 0.9163, val_error: 0.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 1.0, correct 1/1
class 2: acc None, correct 0/0
EarlyStopping counter: 16 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 25, train_loss: 0.9452, train_clustering_loss:  0.7223, train_error: 0.3529
class 0: acc 0.14285714285714285, correct 1/7
class 1: acc 1.0, correct 4/4
class 2: acc 1.0, correct 6/6
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.1026, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 17 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 26, train_loss: 0.8330, train_clustering_loss:  0.6936, train_error: 0.2941
class 0: acc 1.0, correct 5/5
class 1: acc 0.0, correct 0/4
class 2: acc 0.875, correct 7/8
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.4834, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 18 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 27, train_loss: 0.9568, train_clustering_loss:  0.7148, train_error: 0.4118
class 0: acc 0.8, correct 4/5
class 1: acc 0.0, correct 0/6
class 2: acc 1.0, correct 6/6
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.2523, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 19 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 28, train_loss: 0.8411, train_clustering_loss:  0.7012, train_error: 0.2941
class 0: acc 1.0, correct 8/8
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.5, correct 3/6
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.2275, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 20 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 29, train_loss: 0.8944, train_clustering_loss:  0.6910, train_error: 0.3529
class 0: acc 1.0, correct 6/6
class 1: acc 0.2, correct 1/5
class 2: acc 0.6666666666666666, correct 4/6
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.3320, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 21 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 30, train_loss: 0.8159, train_clustering_loss:  0.6885, train_error: 0.1176
class 0: acc 1.0, correct 8/8
class 1: acc 0.0, correct 0/2
class 2: acc 1.0, correct 7/7
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.8565, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 22 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 31, train_loss: 0.8591, train_clustering_loss:  0.7030, train_error: 0.3529
class 0: acc 1.0, correct 3/3
class 1: acc 0.25, correct 2/8
class 2: acc 1.0, correct 6/6
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.1404, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 23 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 32, train_loss: 0.8349, train_clustering_loss:  0.6978, train_error: 0.1176
class 0: acc 1.0, correct 8/8
class 1: acc 1.0, correct 6/6
class 2: acc 0.3333333333333333, correct 1/3
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.0729, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 24 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 33, train_loss: 0.8210, train_clustering_loss:  0.6771, train_error: 0.2353
class 0: acc 1.0, correct 7/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 0.0, correct 0/3
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.1071, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 25 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 34, train_loss: 0.9013, train_clustering_loss:  0.6856, train_error: 0.4706
class 0: acc 1.0, correct 2/2
class 1: acc 0.7777777777777778, correct 7/9
class 2: acc 0.0, correct 0/6
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 0.7267, val_error: 0.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 1.0, correct 1/1
class 2: acc None, correct 0/0
Validation loss decreased (0.847017 --> 0.726720).  Saving model ...




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 35, train_loss: 0.8401, train_clustering_loss:  0.6737, train_error: 0.3529
class 0: acc 0.42857142857142855, correct 3/7
class 1: acc 1.0, correct 5/5
class 2: acc 0.6, correct 3/5
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.0411, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 1 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 36, train_loss: 0.7753, train_clustering_loss:  0.6722, train_error: 0.2353
class 0: acc 1.0, correct 5/5
class 1: acc 0.6666666666666666, correct 4/6
class 2: acc 0.6666666666666666, correct 4/6
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.1673, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 2 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 37, train_loss: 0.6609, train_clustering_loss:  0.6635, train_error: 0.1765
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 8/8
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.6492, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 3 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 38, train_loss: 0.6033, train_clustering_loss:  0.6178, train_error: 0.1765
class 0: acc 1.0, correct 7/7
class 1: acc 0.0, correct 0/3
class 2: acc 1.0, correct 7/7
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.6495, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 4 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.0: correct 0/136
Epoch: 39, train_loss: 0.5421, train_clustering_loss:  0.5931, train_error: 0.1765
class 0: acc 1.0, correct 7/7
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 0.8571428571428571, correct 6/7
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.3711, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 5 out of 20




class 0 clustering acc 0.9975490196078431: correct 407/408
class 1 clustering acc 0.007352941176470588: correct 1/136
Epoch: 40, train_loss: 0.7893, train_clustering_loss:  0.6408, train_error: 0.2941
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 0.3333333333333333, correct 2/6
class 2: acc 1.0, correct 5/5
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 0.9628, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 6 out of 20




class 0 clustering acc 0.9950980392156863: correct 406/408
class 1 clustering acc 0.051470588235294115: correct 7/136
Epoch: 41, train_loss: 0.5808, train_clustering_loss:  0.6162, train_error: 0.1176
class 0: acc 0.8571428571428571, correct 6/7
class 1: acc 0.8571428571428571, correct 6/7
class 2: acc 1.0, correct 3/3
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.6972, val_error: 1.0000, auc: nan
class 0 clustering acc 0.75: correct 18/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 7 out of 20




class 0 clustering acc 0.9950980392156863: correct 406/408
class 1 clustering acc 0.21323529411764705: correct 29/136
Epoch: 42, train_loss: 0.6908, train_clustering_loss:  0.6125, train_error: 0.2941
class 0: acc 1.0, correct 6/6
class 1: acc 0.75, correct 3/4
class 2: acc 0.42857142857142855, correct 3/7
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 0.8878, val_error: 0.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 1.0, correct 1/1
class 2: acc None, correct 0/0
EarlyStopping counter: 8 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.03676470588235294: correct 5/136
Epoch: 43, train_loss: 0.8565, train_clustering_loss:  0.6465, train_error: 0.4706
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 0.25, correct 2/8
class 2: acc 1.0, correct 3/3
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 0.8133, val_error: 1.0000, auc: nan
class 0 clustering acc 1.0: correct 24/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 9 out of 20




class 0 clustering acc 0.9607843137254902: correct 392/408
class 1 clustering acc 0.21323529411764705: correct 29/136
Epoch: 44, train_loss: 0.7029, train_clustering_loss:  0.6026, train_error: 0.3529
class 0: acc 0.875, correct 7/8
class 1: acc 0.25, correct 1/4
class 2: acc 0.6, correct 3/5
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.3926, val_error: 1.0000, auc: nan
class 0 clustering acc 0.75: correct 18/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 10 out of 20




class 0 clustering acc 1.0: correct 408/408
class 1 clustering acc 0.08823529411764706: correct 12/136
Epoch: 45, train_loss: 0.5812, train_clustering_loss:  0.5855, train_error: 0.1765
class 0: acc 0.8333333333333334, correct 5/6
class 1: acc 1.0, correct 5/5
class 2: acc 0.6666666666666666, correct 4/6
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.5003, val_error: 1.0000, auc: nan
class 0 clustering acc 0.9583333333333334: correct 23/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 11 out of 20




class 0 clustering acc 0.9901960784313726: correct 404/408
class 1 clustering acc 0.22794117647058823: correct 31/136
Epoch: 46, train_loss: 0.3783, train_clustering_loss:  0.5148, train_error: 0.1176
class 0: acc 1.0, correct 6/6
class 1: acc 0.3333333333333333, correct 1/3
class 2: acc 1.0, correct 8/8
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.7421, val_error: 1.0000, auc: nan
class 0 clustering acc 0.75: correct 18/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 12 out of 20




class 0 clustering acc 0.9803921568627451: correct 400/408
class 1 clustering acc 0.23529411764705882: correct 32/136
Epoch: 47, train_loss: 0.4512, train_clustering_loss:  0.5393, train_error: 0.1765
class 0: acc 1.0, correct 6/6
class 1: acc 0.5, correct 3/6
class 2: acc 1.0, correct 5/5
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 1.7247, val_error: 1.0000, auc: nan
class 0 clustering acc 0.7083333333333334: correct 17/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 13 out of 20




class 0 clustering acc 0.9975490196078431: correct 407/408
class 1 clustering acc 0.15441176470588236: correct 21/136
Epoch: 48, train_loss: 0.4244, train_clustering_loss:  0.5310, train_error: 0.1176
class 0: acc 1.0, correct 6/6
class 1: acc 0.7142857142857143, correct 5/7
class 2: acc 1.0, correct 4/4
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 0.7146, val_error: 0.0000, auc: nan
class 0 clustering acc 0.7916666666666666: correct 19/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 1.0, correct 1/1
class 2: acc None, correct 0/0
Validation loss decreased (0.726720 --> 0.714625).  Saving model ...




class 0 clustering acc 0.9975490196078431: correct 407/408
class 1 clustering acc 0.18382352941176472: correct 25/136
Epoch: 49, train_loss: 0.4792, train_clustering_loss:  0.5442, train_error: 0.1176
class 0: acc 0.6666666666666666, correct 4/6
class 1: acc 1.0, correct 4/4
class 2: acc 1.0, correct 7/7
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:451: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
NaN or Inf found in input tensor.

Val Set, val_loss: 2.0636, val_error: 1.0000, auc: nan
class 0 clustering acc 0.6666666666666666: correct 16/24
class 1 clustering acc 0.0: correct 0/8
class 0: acc None, correct 0/0
class 1: acc 0.0, correct 0/1
class 2: acc None, correct 0/0
EarlyStopping counter: 1 out of 20
Val error: 0.0000, ROC AUC: nan
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:528: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1007: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/skoc/Git_repos/CLAM/utils/core_utils.py:528: RuntimeWarning: Mean of empty slice
  auc = np.nanmean(np.array(aucs))
Test error: 0.0000, ROC AUC: nan
class 0: acc None, correct 0/0
Traceback (most recent call last):
  File "main.py", line 209, in <module>
    results = main(args)
  File "main.py", line 49, in main
    results, test_auc, val_auc, test_acc, val_acc  = train(datasets, i, args)
  File "/home/skoc/Git_repos/CLAM/utils/core_utils.py", line 210, in train
    writer.add_scalar('final/test_class_{}_acc'.format(i), acc, 0)
  File "/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/tensorboardX/writer.py", line 457, in add_scalar
    scalar(tag, scalar_value, display_name, summary_description), global_step, walltime)
  File "/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/tensorboardX/summary.py", line 151, in scalar
    scalar = make_np(scalar)
  File "/home/skoc/Git_repos/CLAM/venv_clam/lib/python3.8/site-packages/tensorboardX/x2num.py", line 35, in make_np
    raise NotImplementedError(
NotImplementedError: Got <class 'NoneType'>, but expected numpy array or torch tensor.
